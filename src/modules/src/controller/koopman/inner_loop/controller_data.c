#include "controller_koopman.h"
// Hardcoded feedback gains and scheduling points


// Inner loop controller data
float y0_[9] = {0.00376082, 0.0122124, 0.0112277, 0.00135606, -0.0269593, 0.0271975, -0.000793904, -0.00619731, 0.0158706};
float ystd[9] = {0.496331, 0.32921, 0.555163, 0.146331, 0.224038, 0.0208025, 0.764423, 1.21606, 0.107134};
float u0[4] = {0.26278, 0.000134717, 0.00123984, 0.000585482};
float ustd[4] = {0.05476, 0.0071263, 0.00904266, 0.000279072};


// Filter A and B matrices
float Wz_lpv_A[8][8] = {
    {0.995758, 0, 0, 0, 0, 0, 0, 0},
    {0, 0.995758, 0, 0, 0, 0, 0, 0},
    {0, 0, 0.995758, 0, 0, 0, 0, 0},
    {0, 0, 0, 0.995758, 0, 0, 0, 0},
    {0, 0, 0, 0, 0.669588, 0, 0, 0},
    {0, 0, 0, 0, 0, 0.106524, 0, 0},
    {0, 0, 0, 0, 0, 0, 0.106524, 0},
    {0, 0, 0, 0, 0, 0, 0, 0.106524}
};
float Wz_lpv_B[8][8] = {
    {0.0625, 0, 0, 0, 0, 0, 0, 0},
    {0, 0.0625, 0, 0, 0, 0, 0, 0},
    {0, 0, 0.0625, 0, 0, 0, 0, 0},
    {0, 0, 0, 0.0625, 0, 0, 0, 0},
    {0, 0, 0, 0, 0.25, 0, 0, 0},
    {0, 0, 0, 0, 0, 0.25, 0, 0},
    {0, 0, 0, 0, 0, 0, 0.25, 0},
    {0, 0, 0, 0, 0, 0, 0, 0.25}
};


// Interpolation data
float p_normed_LPV_grid[6][grid_point_num] = {
    {-0.0099737, 0.415787, -0.329286, 0.401605, -0.285721, 0.275017, 0.489192, 0.103933, 0.422642, -0.0271039, 0.335289, -0.237959, -0.0842292, -0.378822, 0.0480202, 0.374212, -0.170845, 0.0119757, 0.435582, -0.198295, -0.237877},
    {0.15739, -1.92131, -0.251131, -0.556873, 0.910576, -1.15687, -0.853342, -0.720989, -1.69407, -0.435927, -1.30682, 0.354417, 0.00895125, 0.786126, 0.0836356, -1.90892, 0.811898, -0.237945, -1.40693, 0.107298, -0.497724},
    {-0.110006, -0.201241, -1.00159, -0.153287, -0.466848, -1.42263, 0.148108, -1.36579, -0.409271, -1.18195, -1.32093, -0.865912, -0.914843, -0.445835, -0.374458, -0.273486, -0.418489, -0.901978, -1.17184, -0.777151, -1.41894},
    {0.013326, 0.23954, -0.0890173, 0.0892462, 0.547328, -0.106207, 0.693099, 0.083186, -0.197545, -0.676018, -0.467898, -0.267429, -0.259585, 0.526255, 0.447848, 0.211957, 0.113922, -0.0328555, -1.03158, -0.658186, -0.268195},
    {-0.00361414, -0.338565, 1.14761, -0.579015, -1.02105, 1.44065, -2.45662, 0.130645, 0.94202, 2.04432, 0.605021, 0.581078, -0.235414, 0.25263, -1.8673, -0.0552871, -0.374146, 0.442104, 1.43518, 1.35722, 1.74796},
    {-0.315385, -0.0378432, 0.149782, 0.862779, 0.274152, 0.892585, 0.180056, 0.143123, 0.615847, 0.794564, 0.592639, 0.618065, -0.109417, 0.799375, 0.301966, 0.730991, 0.470225, -0.165247, 0.460217, 0.84513, 0.348864}
};
uint8_t K_LPV_grid_uint8[nu][nx_full][grid_point_num] = {
    {
        {147, 194, 201, 119, 214, 1, 162, 25, 215, 186, 3, 164, 240, 227, 214, 242, 201, 121, 0, 215, 255},
        {147, 156, 137, 50, 137, 77, 143, 39, 137, 160, 80, 168, 255, 129, 145, 136, 145, 0, 99, 170, 146},
        {242, 246, 246, 126, 246, 29, 244, 0, 255, 248, 31, 243, 231, 224, 246, 224, 247, 176, 51, 242, 225},
        {105, 65, 55, 68, 42, 55, 84, 45, 255, 3, 55, 99, 148, 72, 41, 48, 0, 200, 63, 36, 84},
        {70, 95, 95, 171, 101, 221, 78, 255, 0, 71, 220, 82, 108, 124, 103, 132, 78, 81, 200, 115, 132},
        {220, 233, 218, 155, 224, 0, 231, 3, 117, 230, 1, 221, 234, 232, 239, 224, 222, 255, 3, 240, 220},
        {201, 238, 244, 24, 249, 4, 212, 16, 227, 245, 4, 218, 242, 188, 251, 207, 255, 82, 0, 245, 212},
        {68, 49, 45, 166, 40, 242, 63, 255, 16, 0, 241, 58, 25, 112, 39, 97, 3, 71, 231, 41, 103},
        {99, 55, 48, 138, 37, 255, 85, 236, 34, 62, 254, 83, 11, 27, 36, 12, 49, 132, 254, 36, 0},
        {108, 93, 110, 207, 109, 199, 109, 234, 116, 88, 197, 86, 0, 117, 100, 108, 100, 255, 178, 77, 100},
        {17, 9, 8, 127, 6, 231, 13, 255, 0, 7, 229, 15, 21, 26, 6, 24, 6, 80, 210, 11, 23},
        {156, 171, 156, 44, 157, 47, 155, 10, 152, 178, 50, 176, 255, 141, 164, 150, 167, 0, 70, 184, 157},
        {72, 38, 34, 135, 26, 255, 61, 253, 29, 45, 253, 58, 3, 20, 25, 10, 36, 125, 245, 23, 0},
        {170, 203, 204, 94, 213, 62, 185, 35, 50, 255, 64, 181, 160, 172, 216, 192, 250, 0, 79, 226, 166},
        {189, 146, 132, 76, 120, 226, 176, 149, 26, 204, 226, 177, 72, 42, 123, 36, 174, 12, 255, 130, 0},
        {9, 3, 1, 105, 0, 229, 5, 255, 4, 7, 227, 8, 22, 11, 1, 12, 5, 62, 206, 6, 11},
        {249, 221, 201, 73, 191, 129, 240, 34, 74, 255, 131, 248, 166, 133, 198, 129, 225, 0, 175, 214, 102},
        {21, 13, 16, 135, 16, 224, 19, 255, 11, 12, 222, 14, 0, 32, 14, 30, 15, 106, 200, 12, 27},
        {243, 251, 248, 122, 249, 32, 245, 0, 247, 255, 34, 248, 252, 228, 251, 231, 253, 152, 57, 251, 232},
        {147, 149, 130, 16, 127, 41, 139, 0, 182, 147, 44, 166, 255, 109, 135, 113, 133, 10, 65, 155, 129},
        {61, 43, 49, 176, 46, 227, 58, 255, 53, 35, 224, 46, 0, 67, 42, 59, 40, 184, 205, 33, 54},
        {174, 168, 148, 53, 143, 49, 165, 0, 187, 155, 52, 189, 255, 138, 150, 135, 139, 50, 79, 168, 149},
        {52, 20, 13, 126, 5, 255, 40, 253, 11, 19, 253, 43, 21, 14, 5, 4, 8, 96, 246, 11, 0},
        {56, 44, 49, 156, 47, 233, 55, 255, 15, 52, 231, 45, 0, 53, 45, 51, 53, 133, 213, 41, 39},
        {135, 125, 142, 231, 142, 207, 140, 233, 88, 132, 204, 113, 0, 147, 135, 141, 143, 255, 190, 114, 122},
        {25, 12, 17, 151, 15, 218, 21, 255, 51, 0, 215, 16, 10, 40, 12, 34, 5, 158, 192, 6, 37},
        {145, 187, 191, 113, 201, 0, 157, 18, 224, 170, 2, 164, 255, 221, 202, 233, 182, 120, 1, 206, 251},
        {213, 235, 240, 130, 245, 15, 223, 0, 198, 252, 17, 218, 208, 225, 245, 235, 255, 154, 32, 244, 228},
        {167, 212, 216, 114, 228, 0, 182, 8, 203, 213, 2, 185, 250, 231, 230, 247, 223, 103, 6, 234, 255},
        {142, 197, 199, 105, 213, 0, 159, 12, 161, 193, 2, 166, 253, 227, 216, 246, 203, 49, 5, 227, 255},
        {59, 29, 17, 109, 8, 255, 46, 243, 8, 33, 254, 55, 49, 12, 11, 4, 18, 61, 251, 22, 0},
        {143, 86, 71, 119, 55, 239, 123, 188, 50, 101, 239, 128, 50, 32, 57, 15, 76, 120, 255, 63, 0},
        {255, 185, 170, 90, 149, 90, 232, 0, 198, 183, 91, 233, 118, 105, 149, 79, 158, 184, 135, 144, 69},
        {77, 48, 44, 131, 37, 255, 69, 247, 0, 65, 253, 65, 3, 25, 37, 18, 54, 94, 248, 38, 2},
        {50, 27, 29, 154, 25, 234, 43, 255, 39, 21, 232, 37, 0, 40, 22, 31, 21, 153, 215, 16, 28},
        {117, 177, 183, 111, 199, 7, 135, 40, 184, 172, 8, 142, 249, 219, 201, 240, 188, 87, 0, 208, 255},
        {61, 36, 30, 126, 24, 255, 52, 251, 0, 48, 254, 54, 23, 22, 25, 16, 37, 80, 246, 30, 5},
        {44, 26, 28, 145, 24, 235, 39, 255, 23, 26, 233, 33, 0, 35, 22, 28, 25, 129, 216, 18, 22},
        {117, 193, 200, 148, 221, 116, 145, 149, 62, 224, 117, 144, 215, 222, 225, 255, 236, 0, 104, 240, 245},
        {131, 108, 123, 178, 118, 129, 130, 143, 134, 97, 127, 106, 0, 120, 110, 106, 107, 255, 121, 85, 98},
        {0, 21, 30, 150, 37, 193, 7, 255, 45, 6, 191, 5, 54, 79, 35, 85, 20, 115, 157, 35, 95},
        {0, 20, 24, 140, 30, 202, 5, 255, 36, 7, 200, 7, 70, 69, 30, 75, 18, 86, 170, 35, 85},
        {130, 175, 189, 145, 201, 11, 146, 53, 220, 154, 12, 141, 200, 228, 199, 240, 176, 171, 0, 192, 255},
        {179, 99, 73, 91, 49, 225, 146, 149, 147, 86, 225, 165, 126, 29, 53, 0, 54, 134, 255, 62, 4},
        {178, 174, 189, 138, 189, 0, 181, 8, 248, 157, 0, 164, 110, 185, 182, 177, 171, 255, 4, 157, 181},
        {225, 247, 249, 139, 254, 16, 234, 0, 222, 247, 19, 231, 237, 246, 255, 252, 251, 157, 35, 254, 252},
        {90, 154, 171, 154, 190, 21, 113, 82, 167, 142, 21, 106, 182, 223, 187, 243, 169, 137, 0, 182, 255},
        {234, 242, 242, 120, 243, 30, 238, 0, 224, 255, 32, 237, 221, 216, 244, 220, 253, 153, 53, 242, 215}
    },
    {
        {157, 179, 194, 111, 187, 6, 173, 27, 136, 88, 6, 157, 29, 21, 185, 55, 93, 255, 0, 188, 53},
        {28, 6, 7, 182, 4, 212, 15, 255, 106, 144, 211, 28, 131, 92, 0, 85, 134, 61, 198, 8, 72},
        {203, 204, 196, 159, 198, 3, 204, 0, 171, 224, 4, 205, 255, 199, 205, 203, 216, 222, 14, 213, 203},
        {53, 40, 33, 255, 20, 43, 57, 19, 109, 21, 49, 50, 115, 16, 25, 0, 4, 175, 53, 27, 5},
        {77, 88, 103, 76, 99, 231, 78, 255, 111, 46, 228, 80, 0, 39, 90, 53, 58, 84, 213, 89, 58},
        {188, 211, 201, 0, 213, 81, 195, 87, 107, 172, 77, 194, 243, 218, 223, 236, 172, 116, 69, 223, 255},
        {200, 241, 242, 0, 246, 204, 207, 216, 92, 196, 198, 216, 224, 162, 254, 205, 198, 55, 177, 255, 222},
        {173, 159, 159, 90, 159, 100, 164, 47, 244, 201, 104, 170, 255, 214, 156, 232, 194, 0, 129, 143, 240},
        {96, 75, 61, 140, 68, 250, 81, 229, 116, 159, 250, 96, 214, 226, 69, 193, 155, 0, 255, 66, 195},
        {228, 250, 247, 72, 251, 52, 241, 0, 147, 103, 54, 228, 126, 171, 255, 173, 113, 183, 68, 246, 189},
        {30, 26, 32, 88, 30, 254, 27, 255, 68, 22, 253, 29, 0, 54, 24, 45, 28, 2, 243, 16, 45},
        {33, 6, 8, 200, 4, 202, 17, 255, 114, 172, 200, 32, 151, 96, 0, 91, 161, 74, 188, 11, 72},
        {88, 73, 62, 123, 68, 253, 76, 234, 105, 126, 253, 87, 164, 189, 68, 162, 124, 0, 255, 63, 164},
        {147, 146, 147, 0, 160, 132, 136, 170, 112, 248, 127, 150, 179, 221, 158, 232, 255, 42, 124, 163, 221},
        {113, 90, 76, 128, 85, 231, 94, 224, 122, 216, 230, 114, 249, 255, 86, 226, 212, 0, 236, 88, 220},
        {34, 29, 33, 91, 31, 252, 30, 255, 66, 35, 251, 32, 17, 60, 26, 51, 39, 0, 241, 20, 50},
        {95, 72, 58, 110, 67, 181, 76, 188, 116, 222, 179, 97, 255, 239, 69, 219, 215, 0, 183, 73, 213},
        {71, 76, 82, 65, 82, 255, 73, 240, 80, 20, 254, 70, 0, 76, 77, 70, 31, 15, 247, 65, 76},
        {183, 180, 173, 159, 175, 0, 181, 11, 164, 234, 1, 185, 255, 189, 181, 195, 225, 210, 8, 191, 191},
        {36, 9, 6, 232, 2, 219, 22, 255, 117, 152, 219, 35, 164, 99, 0, 86, 137, 81, 208, 8, 72},
        {190, 217, 215, 56, 220, 245, 205, 159, 137, 0, 246, 190, 41, 169, 220, 156, 20, 91, 255, 194, 187},
        {43, 11, 5, 255, 0, 184, 27, 220, 139, 181, 185, 42, 215, 125, 0, 110, 163, 102, 178, 11, 97},
        {53, 36, 30, 134, 33, 255, 42, 248, 95, 99, 255, 52, 125, 142, 31, 119, 97, 0, 252, 26, 119},
        {111, 116, 114, 37, 122, 255, 109, 229, 89, 77, 253, 111, 70, 164, 119, 150, 89, 0, 253, 107, 158},
        {224, 246, 242, 19, 251, 41, 233, 0, 137, 139, 40, 226, 148, 204, 255, 211, 150, 147, 54, 247, 225},
        {132, 145, 153, 168, 147, 253, 144, 219, 136, 2, 255, 130, 0, 67, 143, 61, 13, 155, 252, 130, 73},
        {135, 154, 169, 132, 159, 7, 150, 31, 133, 74, 7, 135, 23, 1, 157, 33, 77, 255, 0, 161, 31},
        {224, 239, 240, 103, 245, 1, 231, 14, 168, 225, 0, 227, 203, 191, 248, 211, 226, 246, 5, 255, 211},
        {163, 183, 198, 109, 192, 7, 176, 38, 143, 121, 6, 164, 55, 44, 190, 79, 126, 255, 0, 195, 75},
        {146, 167, 190, 95, 181, 15, 159, 65, 143, 110, 13, 146, 7, 3, 175, 50, 118, 255, 0, 182, 41},
        {46, 27, 22, 137, 24, 253, 34, 255, 93, 109, 252, 45, 127, 138, 22, 116, 106, 0, 248, 20, 113},
        {86, 59, 42, 161, 50, 251, 67, 240, 119, 188, 251, 86, 250, 241, 52, 206, 179, 0, 255, 52, 204},
        {65, 41, 18, 109, 26, 58, 50, 35, 75, 158, 60, 67, 255, 199, 33, 167, 144, 0, 74, 37, 169},
        {99, 84, 75, 110, 82, 255, 86, 243, 111, 152, 254, 99, 175, 207, 82, 183, 152, 0, 255, 78, 184},
        {78, 76, 71, 90, 74, 251, 77, 204, 83, 18, 252, 77, 57, 124, 72, 99, 25, 0, 255, 58, 112},
        {146, 169, 188, 117, 180, 50, 162, 83, 138, 81, 49, 146, 0, 4, 175, 41, 87, 255, 38, 178, 38},
        {71, 56, 50, 116, 55, 255, 59, 251, 99, 121, 254, 70, 135, 162, 52, 141, 121, 0, 252, 49, 140},
        {79, 75, 73, 84, 76, 255, 75, 226, 85, 48, 255, 78, 62, 128, 73, 107, 56, 0, 255, 62, 114},
        {191, 217, 247, 41, 246, 191, 199, 255, 168, 172, 184, 191, 0, 85, 234, 135, 192, 195, 164, 234, 123},
        {239, 252, 244, 115, 249, 45, 247, 0, 173, 162, 46, 240, 205, 213, 255, 212, 165, 203, 63, 250, 225},
        {188, 211, 232, 175, 223, 247, 204, 255, 192, 72, 246, 186, 0, 59, 216, 84, 85, 250, 232, 207, 88},
        {138, 152, 169, 167, 161, 242, 148, 255, 159, 63, 242, 136, 0, 48, 153, 64, 73, 192, 228, 147, 64},
        {171, 195, 208, 106, 201, 2, 188, 9, 140, 77, 2, 171, 35, 34, 201, 64, 83, 255, 0, 201, 67},
        {54, 19, 0, 212, 3, 230, 34, 218, 117, 166, 232, 53, 255, 204, 6, 163, 150, 9, 236, 9, 161},
        {232, 245, 242, 154, 242, 24, 242, 0, 182, 165, 26, 232, 190, 170, 247, 178, 165, 255, 37, 247, 186},
        {213, 223, 225, 134, 226, 0, 219, 12, 178, 208, 0, 214, 194, 163, 229, 183, 207, 255, 5, 235, 182},
        {171, 200, 217, 87, 210, 16, 190, 28, 137, 68, 16, 171, 0, 20, 208, 56, 79, 255, 11, 207, 58},
        {196, 197, 188, 126, 194, 0, 195, 4, 155, 238, 0, 198, 255, 211, 200, 216, 232, 196, 10, 209, 213}
    },
    {
        {17, 10, 18, 234, 30, 225, 15, 255, 102, 139, 224, 0, 99, 51, 30, 79, 134, 211, 206, 11, 63},
        {68, 33, 0, 139, 6, 231, 48, 255, 131, 112, 231, 74, 233, 170, 17, 127, 96, 69, 223, 25, 141},
        {188, 205, 207, 49, 213, 5, 190, 21, 229, 247, 4, 197, 255, 187, 215, 207, 250, 115, 0, 205, 210},
        {179, 188, 177, 70, 186, 11, 189, 0, 223, 178, 13, 179, 255, 241, 193, 224, 176, 174, 20, 184, 233},
        {19, 4, 3, 203, 1, 254, 13, 255, 3, 12, 254, 12, 7, 35, 0, 28, 8, 128, 251, 6, 24},
        {202, 242, 240, 0, 243, 198, 208, 201, 116, 201, 193, 222, 233, 171, 251, 203, 205, 35, 178, 255, 218},
        {170, 236, 249, 30, 247, 128, 185, 122, 143, 166, 127, 206, 189, 126, 248, 153, 185, 0, 126, 255, 172},
        {131, 63, 55, 255, 36, 71, 107, 20, 145, 15, 76, 104, 40, 129, 31, 109, 0, 193, 111, 27, 128},
        {238, 245, 237, 22, 224, 32, 241, 0, 146, 107, 33, 255, 146, 202, 223, 172, 112, 42, 52, 244, 188},
        {195, 227, 255, 109, 248, 27, 214, 0, 128, 137, 27, 191, 37, 103, 239, 136, 151, 175, 38, 234, 125},
        {81, 64, 59, 198, 52, 247, 80, 227, 29, 3, 248, 74, 5, 82, 51, 55, 0, 131, 255, 63, 55},
        {66, 31, 0, 139, 9, 218, 44, 247, 146, 138, 218, 72, 255, 167, 19, 132, 122, 71, 207, 23, 144},
        {237, 246, 239, 21, 221, 46, 243, 0, 109, 57, 48, 255, 90, 185, 219, 147, 64, 26, 73, 247, 163},
        {76, 60, 63, 130, 54, 220, 54, 255, 62, 127, 216, 88, 80, 23, 50, 41, 126, 0, 202, 62, 39},
        {231, 235, 224, 9, 211, 30, 226, 11, 161, 140, 30, 255, 187, 195, 212, 169, 144, 0, 45, 233, 186},
        {84, 71, 64, 185, 57, 246, 83, 225, 32, 3, 248, 81, 13, 86, 57, 56, 0, 113, 255, 71, 58},
        {230, 228, 213, 10, 203, 50, 220, 46, 190, 171, 49, 255, 237, 216, 205, 192, 172, 0, 58, 224, 213},
        {127, 123, 128, 216, 118, 245, 132, 218, 55, 34, 246, 120, 0, 95, 114, 81, 36, 166, 255, 125, 78},
        {150, 158, 156, 37, 163, 9, 146, 33, 209, 230, 8, 159, 255, 166, 166, 183, 231, 85, 0, 157, 187},
        {62, 37, 0, 49, 9, 122, 47, 140, 136, 101, 124, 74, 255, 178, 23, 129, 87, 20, 119, 30, 149},
        {216, 235, 255, 179, 241, 144, 235, 100, 101, 81, 145, 209, 0, 134, 233, 139, 92, 209, 162, 240, 133},
        {63, 38, 3, 0, 12, 45, 48, 65, 140, 104, 46, 75, 255, 173, 24, 130, 91, 3, 42, 28, 150},
        {238, 223, 197, 71, 176, 147, 237, 90, 90, 1, 150, 255, 99, 231, 178, 152, 0, 34, 180, 217, 177},
        {226, 234, 247, 209, 228, 237, 235, 195, 83, 70, 238, 227, 0, 134, 219, 126, 79, 165, 255, 240, 123},
        {191, 223, 255, 84, 243, 21, 206, 0, 104, 130, 19, 191, 5, 72, 232, 114, 146, 133, 28, 231, 103},
        {139, 143, 153, 253, 149, 231, 154, 195, 72, 49, 234, 122, 0, 119, 144, 110, 52, 255, 245, 147, 99},
        {17, 6, 10, 231, 24, 225, 14, 255, 112, 140, 224, 0, 121, 69, 26, 90, 133, 215, 206, 6, 76},
        {85, 105, 124, 55, 134, 27, 82, 78, 156, 251, 23, 88, 171, 56, 131, 122, 255, 91, 0, 113, 109},
        {14, 4, 9, 217, 21, 220, 8, 255, 101, 143, 218, 0, 110, 49, 22, 75, 137, 185, 199, 4, 62},
        {18, 1, 3, 211, 11, 227, 9, 255, 84, 112, 226, 5, 93, 50, 12, 65, 105, 164, 211, 0, 55},
        {230, 200, 162, 83, 141, 204, 219, 156, 100, 7, 207, 252, 150, 255, 147, 159, 0, 7, 234, 192, 190},
        {235, 239, 226, 0, 216, 23, 234, 0, 163, 129, 24, 255, 191, 218, 217, 187, 132, 24, 39, 238, 205},
        {240, 252, 246, 30, 242, 10, 242, 0, 215, 197, 11, 255, 237, 228, 244, 219, 201, 85, 19, 250, 231},
        {234, 237, 229, 30, 207, 78, 234, 37, 95, 52, 79, 255, 80, 170, 204, 132, 58, 0, 102, 237, 149},
        {234, 247, 255, 144, 237, 129, 251, 68, 84, 33, 132, 234, 0, 162, 230, 137, 43, 162, 159, 249, 140},
        {15, 3, 7, 219, 16, 231, 11, 255, 78, 106, 231, 0, 78, 47, 17, 64, 100, 181, 216, 4, 51},
        {235, 219, 198, 78, 173, 173, 229, 120, 68, 0, 175, 255, 68, 194, 172, 124, 1, 2, 203, 216, 146},
        {243, 248, 254, 199, 233, 212, 255, 152, 83, 35, 214, 243, 0, 165, 225, 135, 43, 171, 241, 250, 137},
        {15, 0, 3, 199, 5, 238, 7, 255, 39, 65, 236, 6, 31, 19, 3, 29, 61, 124, 225, 0, 20},
        {212, 238, 255, 82, 251, 15, 225, 0, 175, 179, 15, 214, 127, 153, 246, 176, 190, 153, 22, 242, 173},
        {27, 17, 23, 238, 25, 255, 28, 255, 35, 41, 255, 10, 0, 37, 23, 41, 37, 191, 249, 18, 29},
        {16, 0, 2, 230, 4, 254, 15, 255, 27, 29, 254, 0, 5, 37, 3, 33, 24, 174, 250, 0, 23},
        {23, 23, 39, 255, 52, 220, 26, 246, 106, 146, 219, 0, 75, 42, 50, 82, 143, 253, 201, 25, 62},
        {237, 239, 221, 14, 216, 19, 237, 0, 203, 157, 21, 255, 248, 253, 221, 217, 157, 58, 34, 235, 237},
        {201, 231, 250, 94, 255, 0, 215, 0, 218, 236, 0, 199, 182, 163, 252, 201, 246, 194, 0, 235, 194},
        {60, 68, 81, 81, 97, 28, 54, 83, 179, 255, 25, 56, 209, 73, 97, 132, 254, 128, 0, 69, 121},
        {20, 14, 27, 248, 36, 234, 20, 255, 77, 113, 233, 0, 48, 31, 33, 60, 110, 220, 218, 16, 42},
        {185, 201, 204, 38, 209, 8, 183, 28, 219, 251, 6, 197, 251, 173, 209, 197, 255, 90, 0, 203, 200}
    },
    {
        {91, 97, 97, 80, 89, 255, 96, 244, 0, 51, 253, 98, 28, 25, 87, 39, 53, 7, 247, 100, 24},
        {52, 91, 116, 28, 130, 21, 62, 53, 17, 115, 17, 55, 3, 44, 122, 37, 136, 255, 0, 109, 51},
        {13, 7, 6, 42, 4, 232, 10, 255, 28, 0, 228, 12, 25, 16, 3, 13, 0, 7, 205, 3, 17},
        {52, 41, 42, 213, 44, 165, 45, 255, 0, 66, 158, 44, 48, 109, 41, 100, 77, 87, 134, 59, 99},
        {236, 252, 255, 140, 253, 44, 241, 0, 217, 248, 47, 245, 214, 180, 252, 191, 246, 197, 73, 253, 188},
        {179, 166, 165, 60, 167, 108, 169, 63, 231, 204, 110, 176, 251, 228, 164, 243, 198, 0, 134, 151, 255},
        {167, 107, 103, 255, 77, 161, 144, 100, 121, 12, 164, 146, 18, 132, 71, 115, 0, 164, 197, 77, 134},
        {120, 132, 134, 15, 141, 7, 124, 21, 248, 249, 7, 125, 255, 104, 145, 128, 226, 117, 0, 133, 124},
        {169, 163, 162, 177, 170, 0, 164, 9, 255, 207, 2, 162, 229, 231, 173, 218, 206, 248, 10, 161, 232},
        {190, 148, 121, 222, 109, 156, 179, 127, 246, 135, 162, 185, 255, 216, 118, 221, 113, 0, 183, 129, 209},
        {237, 242, 243, 212, 246, 18, 239, 0, 233, 254, 22, 237, 233, 243, 247, 243, 254, 255, 43, 245, 241},
        {66, 100, 124, 56, 134, 162, 75, 201, 14, 101, 156, 69, 0, 41, 125, 33, 121, 255, 129, 116, 45},
        {192, 187, 185, 197, 191, 1, 189, 0, 255, 221, 4, 186, 236, 243, 194, 232, 219, 253, 17, 185, 242},
        {121, 139, 148, 0, 151, 255, 126, 216, 199, 130, 255, 126, 135, 79, 150, 79, 128, 194, 239, 125, 95},
        {105, 101, 103, 118, 114, 5, 100, 26, 216, 141, 6, 96, 166, 174, 115, 151, 142, 255, 0, 96, 174},
        {227, 230, 231, 212, 234, 18, 228, 0, 217, 237, 21, 226, 216, 234, 235, 232, 238, 255, 42, 233, 231},
        {68, 71, 79, 56, 93, 17, 64, 46, 230, 148, 17, 60, 169, 143, 94, 124, 147, 255, 0, 66, 155},
        {247, 245, 242, 226, 244, 26, 247, 0, 248, 254, 30, 246, 250, 254, 246, 255, 251, 237, 55, 245, 252},
        {6, 6, 8, 26, 7, 230, 5, 255, 16, 0, 226, 7, 12, 3, 5, 1, 2, 16, 201, 4, 6},
        {51, 76, 96, 85, 108, 61, 55, 110, 5, 92, 56, 48, 0, 64, 101, 49, 111, 255, 36, 92, 64},
        {216, 204, 196, 207, 195, 22, 213, 0, 252, 224, 27, 213, 255, 241, 200, 244, 216, 162, 51, 200, 241},
        {4, 39, 67, 34, 85, 120, 10, 204, 15, 96, 111, 4, 0, 36, 75, 21, 120, 255, 67, 60, 45},
        {192, 193, 195, 187, 202, 0, 191, 0, 237, 227, 2, 188, 223, 230, 203, 223, 227, 255, 15, 195, 231},
        {219, 213, 209, 199, 211, 23, 217, 0, 255, 229, 27, 216, 246, 242, 214, 240, 224, 212, 49, 209, 241},
        {156, 126, 106, 134, 99, 128, 148, 92, 255, 138, 133, 153, 248, 181, 107, 188, 117, 0, 149, 106, 184},
        {243, 238, 231, 252, 229, 24, 244, 0, 210, 229, 28, 243, 229, 253, 231, 255, 228, 188, 58, 240, 245},
        {94, 102, 104, 86, 97, 255, 99, 250, 0, 61, 252, 101, 30, 31, 94, 44, 64, 20, 245, 107, 30},
        {53, 52, 51, 48, 46, 254, 53, 255, 48, 31, 252, 56, 51, 35, 45, 39, 31, 0, 236, 47, 38},
        {77, 85, 87, 60, 80, 255, 82, 247, 0, 44, 252, 84, 21, 15, 78, 27, 46, 10, 243, 87, 15},
        {90, 105, 110, 50, 104, 255, 98, 241, 0, 65, 252, 100, 23, 9, 100, 26, 68, 25, 244, 110, 11},
        {177, 181, 185, 170, 192, 0, 177, 3, 215, 213, 2, 174, 200, 212, 193, 204, 215, 255, 12, 184, 212},
        {145, 142, 144, 159, 154, 0, 141, 19, 247, 194, 1, 137, 213, 219, 156, 202, 195, 255, 3, 140, 222},
        {29, 8, 8, 112, 24, 75, 14, 152, 255, 110, 72, 12, 195, 181, 26, 148, 109, 214, 38, 0, 189},
        {186, 183, 182, 178, 189, 3, 183, 0, 255, 217, 6, 181, 231, 232, 191, 222, 215, 252, 18, 180, 233},
        {219, 212, 207, 219, 209, 12, 217, 0, 255, 234, 16, 215, 251, 253, 213, 250, 230, 219, 36, 210, 251},
        {118, 129, 132, 91, 123, 255, 125, 235, 0, 75, 253, 127, 33, 35, 120, 53, 78, 25, 252, 134, 34},
        {190, 191, 192, 179, 199, 3, 189, 0, 237, 220, 6, 186, 219, 226, 200, 218, 221, 255, 18, 191, 226},
        {223, 218, 215, 217, 217, 14, 222, 0, 255, 236, 18, 220, 247, 252, 220, 247, 233, 235, 39, 217, 249},
        {182, 218, 227, 14, 216, 237, 200, 150, 13, 130, 238, 203, 35, 0, 211, 36, 129, 62, 255, 220, 6},
        {144, 102, 79, 193, 70, 253, 130, 254, 249, 114, 255, 136, 246, 193, 78, 193, 94, 0, 253, 83, 192},
        {240, 249, 246, 187, 237, 57, 248, 0, 106, 206, 61, 249, 153, 161, 237, 184, 203, 107, 99, 255, 156},
        {231, 246, 247, 184, 242, 45, 240, 0, 104, 206, 48, 240, 142, 161, 241, 179, 209, 151, 81, 255, 155},
        {108, 110, 107, 101, 97, 255, 112, 241, 25, 67, 253, 115, 56, 47, 96, 62, 65, 0, 251, 110, 45},
        {117, 116, 120, 155, 132, 7, 113, 44, 208, 173, 7, 109, 180, 196, 132, 178, 177, 255, 0, 118, 198},
        {77, 63, 55, 112, 48, 247, 73, 255, 75, 46, 245, 77, 87, 74, 49, 77, 40, 0, 234, 57, 72},
        {43, 44, 45, 39, 41, 248, 44, 255, 33, 29, 245, 47, 37, 16, 39, 22, 28, 0, 227, 42, 20},
        {122, 127, 125, 99, 114, 255, 127, 231, 23, 74, 253, 131, 56, 46, 113, 64, 73, 0, 255, 128, 44},
        {13, 9, 9, 34, 7, 235, 11, 255, 36, 0, 232, 13, 26, 17, 6, 13, 0, 14, 208, 4, 20}
    }
};
float K_min_val[nu][nx_full] = {
    {-0.687977, -0.167128, 0.00626877, 0.0986983, -0.0155254, -0.00217179, -0.0040872, -0.00809341, 0.915212, -0.551953, -3.11904, -0.393919, 0.0353312, -0.575904, 0.125916, -0.554855, 0.0652722, -1.24636, -0.261549, -0.0525228, -0.572318, 2.02093e-05, -0.266685, -0.564498, -0.293819, -0.312513, -1.85091, -0.212325, -2.25277, -1.21141, -0.27486, 0.318631, 0.994938, -0.152471, -0.480056, -1.25224, -0.705014, -0.801143, -1.06473, 0.243836, -1.45223, -2.19349, -1.38484, 0.787421, 0.204252, -0.276795, -1.9165, -0.103832},
    {-0.215557, -2.45968, -1.07198, -0.32447, -0.0104889, 0.00521815, -0.000450376, -0.00508307, -7.53763, 9.10285, -2.85397, -5.43065, -2.21703, -1.56291, -1.32627, -0.973909, -1.02938, 1.55457, -4.09139, -4.84889, 3.35501, -5.38911, -3.97192, 1.3144, 3.20341, 0.770087, -1.98428, -0.251371, -2.34273, -1.48066, -6.07434, -2.33239, -2.31922, -3.11271, 1.81079, -0.865543, -6.65011, 1.33291, -0.693988, 3.64388, 0.647792, -1.09904, 1.63751, -4.96981, 1.53868, -0.682928, 2.16955, -1.82013},
    {-3.40869, -0.730017, -1.30047, -0.35435, -0.0299946, -0.00107348, 0.00112672, -0.00884098, 5.70127, -1.30047, -3.1554, -1.89651, 2.958, -0.586424, 0.467374, -0.429869, 0.155152, -1.22799, -3.07063, -0.813417, -0.13588, -0.802144, 2.03802, 0.190749, -0.031726, -0.597556, -10.1712, -0.742397, -10.3217, -5.5172, 1.77343, 0.971991, -0.364823, 2.97973, 0.829804, -5.94338, 3.76996, 0.829956, -3.12461, -1.45815, -4.42642, -6.43395, -7.07096, 0.604373, -2.47724, -1.19055, -8.95889, -1.74311},
    {-0.565547, 0.0712465, -0.194586, -0.959468, -0.00154275, -0.00318012, -0.0106017, 0.00698642, -8.09565, -3.59432, -10.0224, 0.369132, -4.35068, 3.43298, 0.303243, -2.24151, 0.412284, -4.2452, 0.488983, -0.904316, -3.16377, -0.79855, -4.71238, -1.47618, 0.0910591, -1.92081, -2.97251, 0.432446, 0.296498, 0.83312, -3.90164, -1.17258, -1.18548, -2.14122, -4.31502, -0.648912, -4.82191, -4.58639, 2.15153, -2.04879, -2.24573, -3.20274, -2.53594, -3.28141, -2.66933, 0.287704, -1.34237, 0.753646}
};
float K_range_val[nu][nx_full] = {
    {0.477353, 0.272573, 0.589078, 0.10739, 0.00969724, 0.00565847, 0.0156006, 0.00943806, 2.7136, 1.70164, 3.51739, 0.708384, 1.31478, 0.549043, 0.144863, 0.651773, 0.100756, 1.55657, 1.53544, 0.532926, 1.124, 0.640866, 1.26422, 0.876228, 0.576164, 0.475566, 1.37521, 0.397861, 1.68507, 0.680988, 1.12582, 0.381251, 0.472424, 1.23896, 1.29201, 0.652029, 2.0752, 1.6604, 0.373371, 0.861455, 0.84912, 1.28326, 0.939885, 0.501183, 0.660642, 0.463305, 0.884657, 1.0422},
    {1.68882, 0.916037, 1.46934, 0.352674, 0.022514, 0.0207931, 0.0154295, 0.0155526, 9.32998, 4.75734, 8.44238, 1.67145, 4.26418, 1.49636, 0.951066, 2.00928, 0.624793, 3.00704, 3.27872, 1.65595, 1.00163, 1.66568, 4.34045, 1.53541, 1.75329, 0.803706, 4.79394, 1.00735, 5.00457, 1.81457, 4.84826, 1.66844, 2.42095, 4.58248, 1.91575, 2.47442, 7.66376, 3.09333, 1.03683, 3.17587, 2.39656, 4.16624, 4.28556, 2.54799, 3.39787, 1.30791, 4.40142, 2.31598},
    {2.40636, 1.01491, 2.13086, 0.58844, 0.0450564, 0.0170531, 0.035473, 0.013861, 12.3285, 6.6155, 11.4529, 2.23136, 3.9266, 1.61276, 1.15071, 2.36608, 0.721337, 4.60123, 4.75686, 1.81024, 2.37297, 2.16597, 2.47452, 1.83623, 2.15012, 1.1058, 6.98597, 0.7809, 7.54572, 4.6868, 2.33849, 2.41715, 5.66297, 3.66855, 2.25088, 5.00397, 4.07146, 2.7901, 3.80314, 5.35599, 5.07843, 7.72397, 4.61417, 4.30455, 3.52281, 0.906034, 6.86062, 3.19453},
    {1.99822, 0.487768, 1.75277, 0.187333, 0.0206549, 0.0178624, 0.0168859, 0.0212436, 11.149, 2.70234, 10.9803, 1.16765, 5.15369, 0.810489, 0.783884, 2.4897, 0.402478, 4.42976, 4.24953, 1.03619, 2.59355, 0.901221, 5.27456, 2.5392, 1.17785, 0.993024, 5.72688, 1.27671, 6.45921, 2.58387, 5.47164, 1.8477, 1.33926, 5.19432, 3.43337, 2.68917, 8.70877, 4.64283, 0.738637, 1.61669, 1.93649, 3.06595, 4.56754, 2.78095, 3.19264, 1.66317, 4.66394, 2.81952}
};
